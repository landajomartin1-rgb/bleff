<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <title>Bleff - El Juego del Diccionario</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .screen {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: fadeIn 0.3s ease-in;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            text-align: center;
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        h2 {
            color: #764ba2;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-style: italic;
        }

        /* Setup Screen */
        .player-input {
            margin-bottom: 15px;
        }

        .player-input input {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            transition: border-color 0.3s;
            -webkit-appearance: none;
            appearance: none;
        }

        .player-input input:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 10px;
            -webkit-tap-highlight-color: rgba(102, 126, 234, 0.3);
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            min-height: 48px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
            opacity: 0.8;
        }

        button.secondary {
            background: #6c757d;
            margin-top: 10px;
        }

        /* Flashcard Screen */
        .flashcard {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            touch-action: manipulation;
            -webkit-tap-highlight-color: rgba(240, 147, 251, 0.3);
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            max-height: 150px;
            overflow: hidden;
        }

        .flashcard.flipped {
            max-height: 90vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .flashcard:active {
            transform: scale(0.98);
        }

        .flashcard-instruction {
            text-align: center;
            color: white;
            font-size: 0.95em;
            font-weight: bold;
            margin-bottom: 12px;
            padding: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .current-reader {
            background: #fff3cd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }

        .current-reader strong {
            color: #856404;
        }

        .word-options {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 12px;
        }

        .word-option {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            transition: all 0.2s;
        }

        .word-title {
            font-size: 1.15em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 6px;
        }

        .word-definition {
            color: #666;
            line-height: 1.4;
            font-size: 0.9em;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.4s ease, opacity 0.4s ease, margin-top 0.4s ease;
        }

        .flashcard.flipped .word-definition {
            max-height: 200px;
            opacity: 1;
            margin-top: 6px;
        }

        .flashcard.flipped .flashcard-instruction {
            display: none;
        }

        /* Score Screen */
        .scoreboard {
            margin: 30px 0;
        }

        .score-track {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .player-score {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            position: relative;
        }

        .player-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 1.2em;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .player-info {
            flex-grow: 1;
        }

        .player-name {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }

        .score-input-section {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .score-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .score-btn {
            padding: 10px;
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .score-btn:hover {
            background: #667eea;
            color: white;
        }

        .round-counter {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        /* Winner Screen */
        .winner-card {
            text-align: center;
            padding: 40px 20px;
        }

        .trophy {
            font-size: 5em;
            margin-bottom: 20px;
        }

        .winner-name {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .final-scores {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }

        .final-score-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #dee2e6;
        }

        .final-score-item:last-child {
            border-bottom: none;
        }

        /* Rules */
        .rules {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .rules h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .rules ul {
            margin-left: 20px;
        }

        .rules li {
            margin-bottom: 8px;
        }

        .add-player-btn {
            background: #28a745;
            width: auto;
            padding: 10px 20px;
            display: inline-block;
            margin-right: 10px;
            min-height: 44px;
        }

        .remove-player-btn {
            background: #dc3545;
            width: auto;
            padding: 10px 20px;
            display: inline-block;
            min-height: 44px;
        }
        
        /* Mejoras para touch en m贸viles */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        button, .flashcard {
            -webkit-tap-highlight-color: rgba(102, 126, 234, 0.3);
        }

        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .screen {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            button {
                min-height: 48px;
                padding: 16px;
            }
            
            .flashcard {
                padding: 20px;
            }
            
            .word-title {
                font-size: 1.2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Setup Screen -->
        <div id="setupScreen" class="screen active">
            <h1> Bleff</h1>
            <p class="subtitle">El Juego del Diccionario</p>
            
            <div class="rules">
                <h3>驴C贸mo se juega?</h3>
                <ul>
                    <li>Cada ronda, un jugador lee 5 palabras raras del celular y elige una</li>
                    <li>Los dem谩s escriben definiciones falsas en papel</li>
                    <li>El lector mezcla las falsas con la verdadera y las lee en voz alta</li>
                    <li>Cada jugador vota cu谩l cree que es la verdadera</li>
                    <li>Votar la correcta: <strong>+2 pts</strong> | Enga帽ar a alguien: <strong>+1 pt</strong></li>
                    <li>Escribir la definici贸n correcta: <strong>+3 pts</strong></li>
                    <li>Si nadie vota la correcta, el lector suma <strong>+2 pts</strong></li>
                </ul>
            </div>

            <h2>Jugadores (2-6)</h2>
            <div id="playerInputs">
                <div class="player-input">
                    <input type="text" placeholder="Nombre del Jugador 1" class="player-name-input">
                </div>
                <div class="player-input">
                    <input type="text" placeholder="Nombre del Jugador 2" class="player-name-input">
                </div>
            </div>

            <button class="add-player-btn" id="addPlayerBtn" ontouchend="addPlayer(event)" onclick="addPlayer(event)">+ Agregar Jugador</button>
            <button class="remove-player-btn" id="removePlayerBtn" ontouchend="removePlayer(event)" onclick="removePlayer(event)">- Quitar Jugador</button>
            <button id="startGameBtn" ontouchend="startGame(event)" onclick="startGame(event)">Comenzar Partida</button>
        </div>

        <!-- Transition Screen -->
        <div id="transitionScreen" class="screen">
            <div style="text-align: center; padding: 40px 20px;">
                <h1> Bleff</h1>
                
                <div class="round-counter" id="transitionRoundCounter">Ronda 1</div>
                
                <div style="margin: 60px 0; padding: 40px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 20px; color: white;">
                    <h2 style="color: white; font-size: 1.3em; margin-bottom: 20px;">Turno de:</h2>
                    <div style="font-size: 2.5em; font-weight: bold; margin: 20px 0;" id="transitionReaderName">Jugador 1</div>
                    <p style="font-size: 1.1em; margin-top: 20px;">Pasale el celular a esta persona</p>
                </div>

                <button id="readerReadyBtn" style="font-size: 1.2em; padding: 20px;" ontouchend="readerReady(event)" onclick="readerReady(event)">Estoy Listo</button>
            </div>
        </div>

        <!-- Flashcard Screen -->
        <div id="flashcardScreen" class="screen">
            <h1> Bleff</h1>
            
            <div class="round-counter" id="roundCounter">Ronda 1</div>
            
            <div class="current-reader" id="currentReader">
                <strong>Lector:</strong> <span id="readerName">Jugador 1</span>
            </div>

            <div class="flashcard" id="flashcard" ontouchend="toggleFlashcard(event)" onclick="toggleFlashcard(event)">
                <div class="flashcard-instruction" id="flashcardInstruction">
                    Toc谩 la flashcard para ver las definiciones 
                </div>
                <div class="word-options" id="wordOptions">
                    <!-- Words will be inserted here by JavaScript -->
                </div>
            </div>

            <button id="goToScoringBtn" ontouchend="goToScoring(event)" onclick="goToScoring(event)">Eleg铆 mi palabra y listo</button>
        </div>

        <!-- Score Screen -->
        <div id="scoreScreen" class="screen">
            <h1> Bleff</h1>
            
            <div class="round-counter" id="scoreRoundCounter">Ronda 1</div>

            <h2>Marcador</h2>
            <div class="scoreboard">
                <div class="score-track" id="scoreTrack">
                    <!-- Player scores will be inserted here -->
                </div>
            </div>

            <div class="score-input-section">
                <h3>Anotar puntos:</h3>
                <p style="margin-bottom: 10px;">Seleccion谩 un jugador y sum谩 puntos:</p>
                <div id="scoreInputButtons">
                    <!-- Score buttons will be inserted here -->
                </div>
            </div>

            <button id="undoBtn" ontouchend="undoLastScore(event)" onclick="undoLastScore(event)" class="secondary" style="background: #dc3545;">╋ Deshacer 煤ltimo punto</button>
            <button id="nextRoundBtn" ontouchend="nextRound(event)" onclick="nextRound(event)">Siguiente Ronda</button>
        </div>

        <!-- Winner Screen -->
        <div id="winnerScreen" class="screen">
            <div class="winner-card">
                <div class="trophy"></div>
                <h1>隆GANADOR!</h1>
                <div class="winner-name" id="winnerName">Jugador 1</div>
                
                <div class="final-scores">
                    <h3 style="margin-bottom: 15px;">Puntuaci贸n Final</h3>
                    <div id="finalScores">
                        <!-- Final scores will be inserted here -->
                    </div>
                </div>

                <button id="resetGameBtn" ontouchend="resetGame(event)" onclick="resetGame(event)">Nueva Partida</button>
            </div>
        </div>
    </div>

    <script>
        // Dictionary with rare Spanish words - varied definition formats
        const dictionary = [
            { word: "ACARONCHAR", definition: "Endurecerse superficialmente un material org谩nico por exposici贸n prolongada al aire seco." },
            { word: "ADERREZAR", definition: "Preparar algo con cuidado ritual antes de su uso." },
            { word: "ALBITAR", definition: "Antiguo especialista en dolencias animales." },
            { word: "ALMFAR", definition: "Toca o prenda antigua usada para cubrir cabeza y cuello." },
            { word: "AMURCAR", definition: "Marchitarse sin llegar a secarse del todo." },
            { word: "ANDORGA", definition: "Barriga prominente." },
            { word: "APOLILLAR", definition: "Deteriorarse lentamente por desuso." },
            { word: "ARGADIJO", definition: "Objeto in煤til conservado por costumbre." },
            { word: "ARROMADIZAR", definition: "Dar forma redondeada sin precisi贸n t茅cnica." },
            { word: "ATURRULLAR", definition: "Confundir con palabras innecesarias." },
            { word: "BALDRAGAS", definition: "Persona de car谩cter d茅bil y voluble." },
            { word: "BARJULETA", definition: "Objeto peque帽o dif铆cil de clasificar." },
            { word: "BASTEDAD", definition: "Condici贸n de lo tosco o sin pulir." },
            { word: "BISLUMBRE", definition: "Percepci贸n apenas consciente." },
            { word: "BOCADEAR", definition: "Respirar con dificultad leve." },
            { word: "BORDONEAR", definition: "Emitir un sonido grave y continuo sin intenci贸n musical." },
            { word: "CACHIPORRAZO", definition: "Golpe torpe y exagerado." },
            { word: "CALETRE", definition: "Capacidad mental pr谩ctica." },
            { word: "CARCAMAL", definition: "Anciano muy deteriorado." },
            { word: "CAZCARRIA", definition: "Suciedad adherida." },
            { word: "CENCELLADA", definition: "Formaci贸n fr谩gil de hielo fino." },
            { word: "CHANFAINA", definition: "Mezcla confusa." },
            { word: "CIMBRAR", definition: "Oscilar levemente." },
            { word: "CLISARSE", definition: "Agotarse de manera imperceptible." },
            { word: "COHOMBRILLO", definition: "Persona insignificante dentro de un grupo." },
            { word: "COLODRILLO", definition: "Parte posterior del cr谩neo." },
            { word: "CONREAR", definition: "Cultivar de forma rudimentaria." },
            { word: "CORUSCANTE", definition: "Que brilla de manera intermitente." },
            { word: "CRISNEJA", definition: "Trenza estrecha." },
            { word: "CUARTERN", definition: "Medida antigua de peso." },
            { word: "DEJEMPLAR", definition: "Apartar algo del uso habitual." },
            { word: "DESBRAVAR", definition: "Quitar aspereza inicial." },
            { word: "DESGAITARSE", definition: "Forzar la voz hasta el cansancio." },
            { word: "DESLECHUGADO", definition: "Sin vigor ni firmeza." },
            { word: "DESMANDURRARSE", definition: "Perder el control progresivamente." },
            { word: "DESOPILAR", definition: "Liberar tensiones internas." },
            { word: "DEXTRORSO", definition: "Que gira hacia la derecha." },
            { word: "DORNAJO", definition: "Recipiente r煤stico para l铆quidos." },
            { word: "EFLUVIO", definition: "Emisi贸n sutil." },
            { word: "EMPELLN", definition: "Empuj贸n brusco." },
            { word: "ENCARTARSE", definition: "Comprometerse sin plena conciencia." },
            { word: "ENCONAR", definition: "Volver persistente un conflicto." },
            { word: "ENGURRUAR", definition: "Arrugar sin orden." },
            { word: "ENJALBEGAR", definition: "Cubrir con una capa superficial blanquecina." },
            { word: "ENQUISTAR", definition: "Volverse problema cr贸nico." },
            { word: "ESCALIVADA", definition: "Asado directo al fuego." },
            { word: "ESCARAPELAR", definition: "Descascararse en capas finas." },
            { word: "ESCARCEO", definition: "Contacto inicial sin profundidad." },
            { word: "ESPICHE", definition: "Tap贸n." },
            { word: "ESPURRIAR", definition: "Salir despedido abruptamente." },
            { word: "ESTANTIGUO", definition: "Aparici贸n nocturna inquietante." },
            { word: "ESTRAMBOTE", definition: "A帽adido innecesario." },
            { word: "FARDACHO", definition: "Persona desali帽ada." },
            { word: "FEMENTIDO", definition: "Traicionero." },
            { word: "FERRAGOSTO", definition: "Periodo de calor intenso." },
            { word: "FILFA", definition: "Mentira." },
            { word: "FOGARADA", definition: "Llamarada breve." },
            { word: "FORNCULO", definition: "Inflamaci贸n localizada." },
            { word: "GALBANA", definition: "Pereza f铆sica." },
            { word: "GAZNPIRO", definition: "Bobo." },
            { word: "GORGORITAR", definition: "Emitir sonido l铆quido." },
            { word: "GUEDEJA", definition: "Mech贸n largo." },
            { word: "HATOJO", definition: "Peque帽o conjunto desordenado." },
            { word: "HOJARASCA", definition: "Restos secos." },
            { word: "HURONEAR", definition: "Investigar con curiosidad excesiva." },
            { word: "JIPIAR", definition: "Sollozar." },
            { word: "JIRN", definition: "Fragmento desgarrado." },
            { word: "LAMPIO", definition: "Sin vello." },
            { word: "LEPRAZO", definition: "Persona moralmente corrupta." },
            { word: "LOBANILLO", definition: "Protuberancia benigna." },
            { word: "MACILENTO", definition: "Extremadamente delgado." },
            { word: "MAJAGRANZAS", definition: "Persona tosca y ruidosa." },
            { word: "MALQUISTAR", definition: "Generar enemistad." },
            { word: "MANGURRINO", definition: "Astuto de poca monta." },
            { word: "MOLICIE", definition: "Blandura excesiva." },
            { word: "MORRIA", definition: "Nostalgia persistente." },
            { word: "MOSTRENCO", definition: "Sin due帽o ni rumbo." },
            { word: "NEBL", definition: "Viento fr铆o y h煤medo." },
            { word: "ORONDO", definition: "Satisfecho en exceso." },
            { word: "PALURDO", definition: "R煤stico." },
            { word: "PAVESA", definition: "Residuo leve del fuego." },
            { word: "PERENDECA", definition: "Mujer fr铆vola." },
            { word: "PINGANILLO", definition: "Peque帽o adorno colgante." },
            { word: "PIZPIRETA", definition: "Vivaz." },
            { word: "QUINCALLA", definition: "Objeto de poco valor." },
            { word: "REDROJO", definition: "Restos in煤tiles." },
            { word: "ZANGOLOTEAR", definition: "Mover sin control." },
            { word: "ZONZO", definition: "Tonto." },
            { word: "ACIDIA", definition: "Tristeza profunda acompa帽ada de apat铆a espiritual." },
            { word: "AGNICIN", definition: "Reconocimiento intelectual de algo previamente desconocido." },
            { word: "ALIPORI", definition: "Verg眉enza que se siente por acciones ajenas." },
            { word: "ALMOTACN", definition: "Funcionario antiguo encargado de controlar pesos y medidas." },
            { word: "AMBLAR", definition: "Caminar el caballo con paso suave y simult谩neo de las patas." },
            { word: "ANACOLUTO", definition: "Ruptura sint谩ctica dentro de una frase." },
            { word: "ANAGNRISIS", definition: "Momento de reconocimiento decisivo en una obra narrativa." },
            { word: "ANFRACTUOSIDAD", definition: "Irregularidad con curvas o entrantes profundas." },
            { word: "APCOPE", definition: "Supresi贸n de uno o m谩s sonidos al final de una palabra." },
            { word: "ATARAXIA", definition: "Estado de imperturbabilidad del 谩nimo." },
            { word: "BLAGO", definition: "Paja larga que queda tras la trilla." },
            { word: "BARUCA", definition: "Desorden ruidoso y confuso." },
            { word: "BELFO", definition: "Labio inferior colgante." },
            { word: "BROCRDICO", definition: "Relativo a un aforismo jur铆dico." },
            { word: "CACUMEN", definition: "Punto m谩s alto o culminaci贸n intelectual." },
            { word: "CALIPIGIA", definition: "Cualidad de poseer nalgas bien formadas." },
            { word: "CENESTESIA", definition: "Sensaci贸n general del estado interno del cuerpo." },
            { word: "CERVIGUILLO", definition: "Parte posterior del cuello." },
            { word: "CLPEO", definition: "Escudo redondo usado en la antig眉edad." },
            { word: "CONCULCAR", definition: "Quebrantar una ley u obligaci贸n." },
            { word: "COROGRAFA", definition: "Descripci贸n detallada de una regi贸n o lugar." },
            { word: "CRISLIDA", definition: "Fase intermedia en la metamorfosis de ciertos insectos." },
            { word: "DECBITO", definition: "Posici贸n del cuerpo tendido horizontalmente." },
            { word: "DECTICO", definition: "Elemento ling眉铆stico cuyo significado depende del contexto." },
            { word: "DELIQUESCENCIA", definition: "Proceso por el cual una sustancia absorbe humedad hasta disolverse." },
            { word: "DIPSOMANA", definition: "Impulso patol贸gico hacia el consumo de alcohol." },
            { word: "DISLALIA", definition: "Trastorno en la articulaci贸n de los sonidos del habla." },
            { word: "ECMENE", definition: "Conjunto de tierras habitadas del planeta." },
            { word: "EGLATRA", definition: "Persona que se admira excesivamente a s铆 misma." },
            { word: "ELZEVIRIO", definition: "Tipo de letra usada en imprenta antigua." },
            { word: "EMTICO", definition: "Sustancia que provoca el v贸mito." },
            { word: "ENTELEQUIA", definition: "Idea abstracta dif铆cil de concretar." },
            { word: "EPNTESIS", definition: "Adici贸n de un sonido dentro de una palabra." },
            { word: "ESCABELO", definition: "Asiento peque帽o sin respaldo." },
            { word: "ESFACELAR", definition: "Destruir un tejido org谩nico por gangrena." },
            { word: "ESPAGIRA", definition: "Antigua rama alqu铆mica relacionada con la medicina." },
            { word: "ESPIRCULO", definition: "Abertura peque帽a para respirar o ventilar." },
            { word: "ESTLIDO", definition: "Torpe de entendimiento." },
            { word: "EXNIME", definition: "Sin fuerzas o sin vida aparente." },
            { word: "EXEQUIAS", definition: "Ceremonias f煤nebres." },
            { word: "FALANGETA", definition: "Hueso peque帽o de los dedos." },
            { word: "FILOGENIA", definition: "Historia evolutiva de una especie." },
            { word: "FISIOGNOMA", definition: "Aspecto exterior del rostro." },
            { word: "FORCLUSIN", definition: "Mecanismo psicoanal铆tico de exclusi贸n de un contenido mental." },
            { word: "FRONDE", definition: "Conjunto de hojas de ciertas plantas." },
            { word: "GLOSOLALIA", definition: "Emisi贸n de sonidos sin sentido ling眉铆stico." },
            { word: "GNOMNICA", definition: "Ciencia que estudia los relojes solares." },
            { word: "HABITUS", definition: "Conjunto de disposiciones adquiridas por experiencia social." },
            { word: "HPAX", definition: "Palabra documentada una sola vez en un corpus." },
            { word: "HELIOCENTRISMO", definition: "Teor铆a que sit煤a al Sol como centro del sistema planetario." },
            { word: "HEMISTIQUIO", definition: "Mitad de un verso." },
            { word: "HETERCLITO", definition: "Irregular o an贸malo." },
            { word: "HIPERESTESIA", definition: "Aumento anormal de la sensibilidad." },
            { word: "HOLOTURIA", definition: "Animal marino tambi茅n llamado pepino de mar." },
            { word: "IDIOLECTO", definition: "Forma particular de hablar de una persona." },
            { word: "IMPRECACIN", definition: "Expresi贸n de deseo de que ocurra un mal." },
            { word: "INERME", definition: "Carente de defensa." },
            { word: "ISAGOGE", definition: "Introducci贸n a una disciplina." },
            { word: "LEPIDPTERO", definition: "Insecto con alas cubiertas de escamas." },
            { word: "LETANA", definition: "Serie mon贸tona y repetitiva." },
            { word: "LOGOMAQUIA", definition: "Discusi贸n centrada solo en palabras." },
            { word: "LOXODROMIA", definition: "Ruta mar铆tima que corta los meridianos con igual 谩ngulo." },
            { word: "MIASMA", definition: "Emanaci贸n considerada nociva." },
            { word: "MORFOFONEMA", definition: "Unidad ling眉铆stica abstracta." },
            { word: "NICTLOPE", definition: "Persona con dificultad para ver de noche." },
            { word: "NUMINOSO", definition: "Que provoca sensaci贸n de misterio sagrado." },
            { word: "OLIGOFRENIA", definition: "Deficiencia intelectual cong茅nita." },
            { word: "ONRICO", definition: "Relacionado con los sue帽os." },
            { word: "OPILACIN", definition: "Obstrucci贸n de los conductos corporales." },
            { word: "ORDALA", definition: "Prueba judicial antigua basada en el juicio divino." },
            { word: "OSMOSIS", definition: "Paso de un solvente a trav茅s de una membrana." },
            { word: "PALIMPSESTO", definition: "Manuscrito reutilizado borrando un texto previo." },
            { word: "PANGNESIS", definition: "Teor铆a antigua sobre la herencia biol贸gica." },
            { word: "PARUSA", definition: "Segunda venida de Cristo seg煤n la teolog铆a cristiana." },
            { word: "PATOGNOMNICO", definition: "S铆ntoma exclusivo de una enfermedad." },
            { word: "PLEONASMO", definition: "Redundancia innecesaria en el lenguaje." },
            { word: "PROLEGMENO", definition: "Discurso preliminar." },
            { word: "PROSOPOPEYA", definition: "Atribuci贸n de cualidades humanas a lo inanimado." },
            { word: "SAPIDEZ", definition: "Cualidad de tener sabor." },
            { word: "SICOFANTE", definition: "Delator o calumniador interesado." },
            { word: "SOMATIZACIN", definition: "Manifestaci贸n f铆sica de un conflicto ps铆quico." },
            { word: "SUBREPCIN", definition: "Obtenci贸n de algo ocultando informaci贸n relevante." },
            { word: "TAUMATURGIA", definition: "Arte de realizar milagros." },
            { word: "TELEONOMA", definition: "Apariencia de finalidad en procesos biol贸gicos." },
            { word: "TOPONIMIA", definition: "Estudio de los nombres de lugares." },
            { word: "UCRONA", definition: "Relato basado en una historia alternativa." },
            { word: "VATICINIO", definition: "Predicci贸n de un suceso futuro." },
            { word: "VELEIDAD", definition: "Voluntad inconstante." },
            { word: "VEROSIMILITUD", definition: "Apariencia de verdad." },
            { word: "XEROFILIA", definition: "Adaptaci贸n a ambientes secos." },
            { word: "ZOONOSIS", definition: "Enfermedad transmitida de animales a humanos." },
            { word: "ABIGEATO", definition: "Robo de ganado." },
            { word: "ACROAMATISMO", definition: "Ense帽anza transmitida de forma oral y reservada." },
            { word: "ACRIBOLOGA", definition: "Uso preciso y exacto del lenguaje." },
            { word: "ADVENTICIO", definition: "Que aparece sin ser propio del lugar." },
            { word: "AGNADO", definition: "Pariente por l铆nea masculina." },
            { word: "ALBUGNEO", definition: "Blanquecino." },
            { word: "ALOTRPICO", definition: "Relativo a las distintas formas de un mismo elemento qu铆mico." },
            { word: "ANATEMA", definition: "Condena solemne." },
            { word: "ANFIDROMA", definition: "Ceremonia griega de presentaci贸n de un reci茅n nacido." },
            { word: "ANTONOMASIA", definition: "Designaci贸n de alguien por una cualidad caracter铆stica." },
            { word: "APODCTICO", definition: "Evidente por s铆 mismo." },
            { word: "APORA", definition: "Dificultad l贸gica sin soluci贸n aparente." },
            { word: "ARQUETIPO", definition: "Modelo original." },
            { word: "ATELAJE", definition: "Conjunto de animales destinados a tirar de un veh铆culo." },
            { word: "AXONOMETRA", definition: "Sistema de representaci贸n gr谩fica tridimensional." },
            { word: "BATRACIO", definition: "Anfibio." },
            { word: "BIFRONTE", definition: "Con dos caras u orientaciones." },
            { word: "BLECUA", definition: "Dormitar." },
            { word: "BRONTOFOBIA", definition: "Miedo a los truenos." },
            { word: "CADUCEO", definition: "Vara simb贸lica asociada a Hermes." },
            { word: "CALCEDONIA", definition: "Variedad microcristalina del cuarzo." },
            { word: "CENOBIO", definition: "Monasterio." },
            { word: "CRVIX", definition: "Cuello uterino." },
            { word: "CICLPEO", definition: "De dimensiones desmesuradas." },
            { word: "CLAUDICACIN", definition: "Debilidad en la marcha por dolor." },
            { word: "COGNOSCIBLE", definition: "Que puede conocerse." },
            { word: "COLIGACIN", definition: "Uni贸n temporal de intereses." },
            { word: "COMMINAR", definition: "Amenazar formalmente." },
            { word: "CONCILIBULO", definition: "Reuni贸n secreta." },
            { word: "CONFLAGRACIN", definition: "Incendio de gran magnitud." },
            { word: "CRATN", definition: "Bloque estable de la corteza terrestre." },
            { word: "CRIPTOGAMIA", definition: "Reproducci贸n vegetal sin flores visibles." },
            { word: "CROMATISMO", definition: "Uso del color." },
            { word: "DEFERENCIA", definition: "Respeto considerado." },
            { word: "DEMTICO", definition: "Relativo al pueblo llano." },
            { word: "DENDRITA", definition: "Prolongaci贸n ramificada de una neurona." },
            { word: "DENTICO", definition: "Relativo al deber." },
            { word: "DESIDERATIVO", definition: "Que expresa deseo." },
            { word: "DIACRONA", definition: "Evoluci贸n de un fen贸meno en el tiempo." },
            { word: "DIASPORA", definition: "Dispersi贸n de un pueblo fuera de su territorio." },
            { word: "DICOTOMA", definition: "Divisi贸n en dos partes excluyentes." },
            { word: "DISPROSIO", definition: "Elemento qu铆mico met谩lico." },
            { word: "ECDTICA", definition: "Ciencia de edici贸n cr铆tica de textos." },
            { word: "EIDTICO", definition: "Relacionado con im谩genes mentales n铆tidas." },
            { word: "ENDOGAMIA", definition: "Matrimonio dentro del mismo grupo social." },
            { word: "EPIGNESIS", definition: "Proceso de desarrollo biol贸gico." },
            { word: "ERISTICA", definition: "Arte de la discusi贸n pol茅mica." },
            { word: "ESCATOLOGA", definition: "Doctrina sobre el fin 煤ltimo." },
            { word: "ESTICOMITIA", definition: "Di谩logo verso a verso en el teatro cl谩sico." },
            { word: "ETIOLOGA", definition: "Estudio de las causas de una enfermedad." },
            { word: "EUPATRIDA", definition: "Miembro de la aristocracia ateniense." },
            { word: "EXGESIS", definition: "Interpretaci贸n profunda de un texto." },
            { word: "EXORDIO", definition: "Parte inicial de un discurso." },
            { word: "FASCCULO", definition: "Conjunto de fibras o documentos agrupados." },
            { word: "FENOMENOLOGA", definition: "Estudio filos贸fico de la experiencia." },
            { word: "FILACTERIA", definition: "Amuleto protector." },
            { word: "FOTOTAXIA", definition: "Movimiento orientado por la luz." },
            { word: "GINECEO", definition: "Espacio reservado a mujeres en la antig眉edad." },
            { word: "HEMIPLEJIA", definition: "Par谩lisis de un lado del cuerpo." },
            { word: "HERMENUTICA", definition: "Teor铆a de la interpretaci贸n." },
            { word: "HETERONOMA", definition: "Dependencia de una norma externa." },
            { word: "HIPLAGE", definition: "Figura ret贸rica de desplazamiento sem谩ntico." },
            { word: "HISTERESIS", definition: "Retraso en la respuesta de un sistema." },
            { word: "HOMOOUSIOS", definition: "De la misma sustancia." },
            { word: "IATROGENIA", definition: "Da帽o causado por intervenci贸n m茅dica." },
            { word: "INMANENCIA", definition: "Cualidad de residir en algo." },
            { word: "INTERREGNO", definition: "Periodo entre dos gobiernos." },
            { word: "ISTOPO", definition: "tomo de un mismo elemento con distinto peso." },
            { word: "KAIRS", definition: "Momento oportuno." },
            { word: "LEXICOGNESIS", definition: "Formaci贸n de palabras nuevas." },
            { word: "LITURGIA", definition: "Rito religioso formalizado." },
            { word: "MACROSCPICO", definition: "Visible a simple vista." },
            { word: "METEMPSICOSIS", definition: "Transmigraci贸n del alma." },
            { word: "MORFOGNESIS", definition: "Formaci贸n de estructuras biol贸gicas." },
            { word: "NEFROLOGA", definition: "Rama m茅dica del ri帽贸n." },
            { word: "NOMOTTICO", definition: "Que establece leyes generales." },
            { word: "NOOSFERA", definition: "mbito del pensamiento humano." },
            { word: "OLIGARQUA", definition: "Gobierno de unos pocos." },
            { word: "ONTOGENIA", definition: "Desarrollo individual de un organismo." },
            { word: "ORTODOXIA", definition: "Fidelidad a una doctrina." },
            { word: "OSTEOLOGA", definition: "Estudio de los huesos." },
            { word: "PALINGENESIA", definition: "Renacimiento c铆clico." },
            { word: "PARESIA", definition: "Par谩lisis leve." },
            { word: "PNEUMA", definition: "Aliento vital." },
            { word: "POLIORCTICA", definition: "Arte del asedio militar." },
            { word: "PROXMICA", definition: "Estudio del uso del espacio interpersonal." },
            { word: "PSICOGNESIS", definition: "Origen ps铆quico de un fen贸meno." },
            { word: "QUIDIDAD", definition: "Esencia de algo." },
            { word: "RAPSODIA", definition: "Composici贸n fragmentaria." },
            { word: "REDUPLICACIN", definition: "Repetici贸n de un elemento ling眉铆stico." },
            { word: "SEMASIOLOGA", definition: "Estudio del significado de las palabras." },
            { word: "SINCDOQUE", definition: "Figura ret贸rica de inclusi贸n parcial." },
            { word: "SOTERIOLOGA", definition: "Doctrina de la salvaci贸n." },
            { word: "TELEOLOGA", definition: "Explicaci贸n por fines." },
            { word: "UBIQUIDAD", definition: "Capacidad de estar en varios lugares." },
            { word: "ZEUGMA", definition: "Figura ret贸rica de elipsis verbal." },
            { word: "ABDUCCIN", definition: "Separaci贸n o alejamiento de una parte del cuerpo respecto del eje central." },
            { word: "ACATALCTICO", definition: "Que no admite interrupci贸n m茅trica." },
            { word: "ACINESIA", definition: "Ausencia o disminuci贸n del movimiento voluntario." },
            { word: "ACRIBIA", definition: "Exactitud extrema." },
            { word: "ACTINISMO", definition: "Efecto qu铆mico de la radiaci贸n luminosa." },
            { word: "AFANISIS", definition: "Desaparici贸n del deseo sexual." },
            { word: "AGNOSTICISMO", definition: "Doctrina que niega la posibilidad de conocer lo absoluto." },
            { word: "AGRAPHIA", definition: "P茅rdida de la capacidad de escribir." },
            { word: "ALETHEIA", definition: "Verdad." },
            { word: "ALITERACIN", definition: "Repetici贸n de sonidos semejantes." },
            { word: "ALOSTASIS", definition: "Mecanismo de adaptaci贸n fisiol贸gica." },
            { word: "AMIMIA", definition: "Incapacidad para realizar gestos expresivos." },
            { word: "ANAMNESIS", definition: "Recuerdo cl铆nico de antecedentes del paciente." },
            { word: "ANISOSILABISMO", definition: "Desigualdad en el n煤mero de s铆labas m茅tricas." },
            { word: "ANOMIA", definition: "Ausencia o quiebra de normas sociales." },
            { word: "ANTFRASIS", definition: "Uso de una palabra con sentido opuesto." },
            { word: "APRAXIA", definition: "Incapacidad para ejecutar actos voluntarios aprendidos." },
            { word: "ARISTIA", definition: "Excelencia." },
            { word: "ASINDETON", definition: "Supresi贸n de conjunciones." },
            { word: "ASTASIA", definition: "Incapacidad para mantenerse de pie." },
            { word: "ATIMIA", definition: "P茅rdida de derechos civiles en la antig眉edad." },
            { word: "AUTARQUA", definition: "Autosuficiencia econ贸mica." },
            { word: "AXILOGA", definition: "Teor铆a de los valores." },
            { word: "BARIATRA", definition: "Especialidad m茅dica sobre la obesidad." },
            { word: "BIBLIOCLASIA", definition: "Destrucci贸n de libros." },
            { word: "BRADILALIA", definition: "Habla anormalmente lenta." },
            { word: "CACOFONA", definition: "Sonoridad desagradable." },
            { word: "CALAMBUR", definition: "Juego de palabras por reagrupaci贸n sil谩bica." },
            { word: "CATAFORESIS", definition: "Movimiento de part铆culas cargadas en un campo el茅ctrico." },
            { word: "CATARSIS", definition: "Liberaci贸n emocional." },
            { word: "CATATONA", definition: "Estado psicomotor de inmovilidad." },
            { word: "CENESTOPATA", definition: "Sensaci贸n corporal an贸mala." },
            { word: "CLADOGNESIS", definition: "Proceso evolutivo de ramificaci贸n." },
            { word: "CLINOCEFALIA", definition: "Inclinaci贸n anormal del cr谩neo." },
            { word: "CONACIN", definition: "Impulso volitivo." },
            { word: "COPROLALIA", definition: "Emisi贸n compulsiva de palabras obscenas." },
            { word: "CRIPTOGRAFA", definition: "Escritura cifrada." },
            { word: "DACTILOLOGA", definition: "Lenguaje de signos manuales." },
            { word: "DEHISCENCIA", definition: "Apertura espont谩nea de un 贸rgano." },
            { word: "DADA", definition: "Conjunto de dos elementos." },
            { word: "DISARTRIA", definition: "Trastorno en la articulaci贸n del habla." },
            { word: "DISFORIA", definition: "Malestar emocional persistente." },
            { word: "DISMETRA", definition: "Falta de coordinaci贸n en la medida del movimiento." },
            { word: "DROMOMANA", definition: "Impulso patol贸gico a viajar." },
            { word: "ECOLALIA", definition: "Repetici贸n involuntaria de palabras ajenas." },
            { word: "EIDETISMO", definition: "Capacidad de evocaci贸n visual intensa." },
            { word: "ENDGENO", definition: "De origen interno." },
            { word: "ENFITEUSIS", definition: "Contrato de cesi贸n perpetua de un bien inmueble." },
            { word: "ENTIMEMA", definition: "Silogismo incompleto." },
            { word: "EPANADIPLOSIS", definition: "Repetici贸n de una palabra al inicio y final de una frase." },
            { word: "EPANORTOSIS", definition: "Correcci贸n inmediata de lo dicho." },
            { word: "EPICLESIS", definition: "Invocaci贸n lit煤rgica." },
            { word: "EPIFONEMA", definition: "Exclamaci贸n final enf谩tica." },
            { word: "EPOJ", definition: "Suspensi贸n del juicio." },
            { word: "ERGONOMA", definition: "Adaptaci贸n del trabajo al ser humano." },
            { word: "ESCANSIN", definition: "Medici贸n del verso." },
            { word: "ESCLEROSIS", definition: "Endurecimiento patol贸gico de un tejido." },
            { word: "ESTENOSIS", definition: "Estrechamiento anormal." },
            { word: "ESTICOMETRA", definition: "C贸mputo de l铆neas de un texto antiguo." },
            { word: "EXOFTALMIA", definition: "Protusi贸n del globo ocular." },
            { word: "FABULACIN", definition: "Construcci贸n imaginaria." },
            { word: "FENOCOPIA", definition: "Rasgo inducido por el ambiente que imita uno gen茅tico." },
            { word: "FONOSMBOLO", definition: "Sonido con valor simb贸lico." },
            { word: "FOTOTROPISMO", definition: "Crecimiento orientado por la luz." },
            { word: "GNOSIA", definition: "Capacidad de reconocimiento sensorial." },
            { word: "GONIOMETRA", definition: "Medici贸n de 谩ngulos." },
            { word: "HAPLOGRAFA", definition: "Omisi贸n involuntaria de una s铆laba repetida." },
            { word: "HETEROCRONA", definition: "Alteraci贸n en los tiempos de desarrollo." },
            { word: "HILEMORFISMO", definition: "Doctrina de materia y forma." },
            { word: "HIPERCINESIA", definition: "Actividad motora excesiva." },
            { word: "HIPOLOGA", definition: "Estudio del caballo." },
            { word: "HOMEOSTASIS", definition: "Equilibrio interno del organismo." },
            { word: "HOMINIZACIN", definition: "Proceso evolutivo humano." },
            { word: "HOMONIMIA", definition: "Igualdad formal entre palabras distintas." },
            { word: "IDIOPATA", definition: "Enfermedad de causa desconocida." },
            { word: "IMAGO", definition: "Fase adulta de un insecto." },
            { word: "INERVACIN", definition: "Distribuci贸n de nervios." },
            { word: "INTEROCEPCIN", definition: "Percepci贸n de est铆mulos internos." },
            { word: "ISOMORFISMO", definition: "Correspondencia estructural." },
            { word: "KINESIA", definition: "Movimiento." },
            { word: "LEXEMA", definition: "Unidad l茅xica m铆nima." },
            { word: "LITOTES", definition: "Afirmaci贸n mediante negaci贸n de lo contrario." },
            { word: "LUMINISCENCIA", definition: "Emisi贸n de luz sin calor." },
            { word: "METONIMIA", definition: "Sustituci贸n sem谩ntica por contig眉idad." },
            { word: "MMESIS", definition: "Imitaci贸n." },
            { word: "MISONESMO", definition: "Aversi贸n a lo nuevo." },
            { word: "MORFEMA", definition: "Unidad m铆nima con significado." },
            { word: "NECROSIS", definition: "Muerte de tejido." },
            { word: "NEOLOGISMO", definition: "Palabra nueva." },
            { word: "NEURASTENIA", definition: "Fatiga nerviosa cr贸nica." },
            { word: "NICTITACIN", definition: "Parpadeo." },
            { word: "ZASCANDIL", definition: "Persona entrometida, bulliciosa y de poco provecho que anda de una parte a otra fingiendo que hace algo." }
        ];

        // Game state
        let players = [];
        let currentRound = 1;
        let currentReaderIndex = 0;
        let currentFlashcard = [];
        let usedFlashcards = [];
        let scoreHistory = []; // Track score changes for undo
        const WINNING_SCORE = 20;

        const playerColors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8', '#F7DC6F'];

        // Prevent duplicate execution (touch + click)
        let lastActionTime = 0;
        let lastActionName = '';
        
        function preventDuplicate(actionName) {
            const now = Date.now();
            if (actionName === lastActionName && now - lastActionTime < 500) {
                return true; // Duplicate, skip
            }
            lastActionTime = now;
            lastActionName = actionName;
            return false; // Not duplicate, proceed
        }

        function addPlayer(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('addPlayer')) return;
            const inputs = document.getElementById('playerInputs');
            const currentCount = inputs.children.length;
            if (currentCount < 6) {
                const div = document.createElement('div');
                div.className = 'player-input';
                div.innerHTML = `<input type="text" placeholder="Nombre del Jugador ${currentCount + 1}" class="player-name-input">`;
                inputs.appendChild(div);
            } else {
                alert('M谩ximo 6 jugadores');
            }
        }

        function removePlayer(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('removePlayer')) return;
            const inputs = document.getElementById('playerInputs');
            if (inputs.children.length > 2) {
                inputs.removeChild(inputs.lastChild);
            } else {
                alert('M铆nimo 2 jugadores');
            }
        }

        function startGame(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('startGame')) return;
            
            console.log('Bleff: Iniciando partida...');
            const inputs = document.querySelectorAll('.player-name-input');
            players = [];
            
            inputs.forEach((input, index) => {
                const name = input.value.trim();
                if (name) {
                    players.push({
                        name: name,
                        score: 0,
                        color: playerColors[index]
                    });
                }
            });

            console.log('Bleff: Jugadores registrados:', players.length);

            if (players.length < 2) {
                alert('Necesit谩s al menos 2 jugadores');
                return;
            }

            currentRound = 1;
            currentReaderIndex = 0;
            usedFlashcards = [];
            
            console.log('Bleff: Mostrando transici贸n...');
            showTransition();
        }

        function getRandomFlashcard() {
            // Get 5 random words that haven't been used
            const available = dictionary.filter(word => 
                !usedFlashcards.some(fc => fc.some(w => w.word === word.word))
            );

            if (available.length < 5) {
                // Reset if we've used all words
                usedFlashcards = [];
                return getRandomFlashcard();
            }

            const flashcard = [];
            const usedIndices = [];

            while (flashcard.length < 5) {
                const randomIndex = Math.floor(Math.random() * available.length);
                if (!usedIndices.includes(randomIndex)) {
                    usedIndices.push(randomIndex);
                    flashcard.push(available[randomIndex]);
                }
            }

            usedFlashcards.push(flashcard);
            return flashcard;
        }

        function showTransition() {
            document.getElementById('transitionRoundCounter').textContent = `Ronda ${currentRound}`;
            document.getElementById('transitionReaderName').textContent = players[currentReaderIndex].name;
            showScreen('transitionScreen');
        }

        function readerReady(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('readerReady')) return;
            showScreen('flashcardScreen');
            loadNewFlashcard();
        }

        function loadNewFlashcard() {
            currentFlashcard = getRandomFlashcard();
            
            document.getElementById('roundCounter').textContent = `Ronda ${currentRound}`;
            document.getElementById('readerName').textContent = players[currentReaderIndex].name;

            const flashcard = document.getElementById('flashcard');
            flashcard.classList.remove('flipped');

            const wordOptions = document.getElementById('wordOptions');
            wordOptions.innerHTML = '';

            currentFlashcard.forEach((wordObj, index) => {
                const div = document.createElement('div');
                div.className = 'word-option';
                div.innerHTML = `
                    <div class="word-title">${wordObj.word}</div>
                    <div class="word-definition">${wordObj.definition}</div>
                `;
                wordOptions.appendChild(div);
            });

            // Update instruction text
            document.getElementById('flashcardInstruction').textContent = 'Toc谩 la flashcard para ver las definiciones ';
        }

        function toggleFlashcard(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('toggleFlashcard')) return;
            const flashcard = document.getElementById('flashcard');
            const instruction = document.getElementById('flashcardInstruction');
            
            if (flashcard.classList.contains('flipped')) {
                flashcard.classList.remove('flipped');
                instruction.textContent = 'Toc谩 la flashcard para ver las definiciones ';
            } else {
                flashcard.classList.add('flipped');
                instruction.textContent = 'Toc谩 nuevamente para ocultar las definiciones ';
            }
        }

        function goToScoring(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('goToScoring')) return;
            showScreen('scoreScreen');
            updateScoreboard();
            createScoreButtons();
            updateUndoButton();
            document.getElementById('scoreRoundCounter').textContent = `Ronda ${currentRound}`;
        }

        function updateScoreboard() {
            const scoreTrack = document.getElementById('scoreTrack');
            scoreTrack.innerHTML = '';

            // Sort players by score for display
            const sortedPlayers = [...players].sort((a, b) => b.score - a.score);

            sortedPlayers.forEach(player => {
                const percentage = Math.min((player.score / WINNING_SCORE) * 100, 100);
                
                const div = document.createElement('div');
                div.className = 'player-score';
                div.innerHTML = `
                    <div class="player-avatar" style="background-color: ${player.color}">
                        ${player.name.charAt(0).toUpperCase()}
                    </div>
                    <div class="player-info">
                        <div class="player-name">${player.name}</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%; background-color: ${player.color}">
                                ${player.score}
                            </div>
                        </div>
                    </div>
                `;
                scoreTrack.appendChild(div);
            });
        }

        function createScoreButtons() {
            const container = document.getElementById('scoreInputButtons');
            container.innerHTML = '';

            players.forEach((player, index) => {
                const playerSection = document.createElement('div');
                playerSection.style.marginBottom = '15px';
                
                const label = document.createElement('div');
                label.style.fontWeight = 'bold';
                label.style.marginBottom = '5px';
                label.textContent = player.name;
                playerSection.appendChild(label);

                const buttonsDiv = document.createElement('div');
                buttonsDiv.className = 'score-buttons';

                const scores = [
                    { points: 1, label: '+1 (Enga帽贸)' },
                    { points: 2, label: '+2 (Vot贸 correcta)' },
                    { points: 3, label: '+3 (Escribi贸 correcta)' },
                    { points: 2, label: '+2 (Nadie vot贸)' }
                ];

                scores.forEach(score => {
                    const btn = document.createElement('button');
                    btn.className = 'score-btn';
                    btn.textContent = score.label;
                    btn.setAttribute('ontouchend', `addScore(${index}, ${score.points}, event)`);
                    btn.setAttribute('onclick', `addScore(${index}, ${score.points}, event)`);
                    buttonsDiv.appendChild(btn);
                });

                playerSection.appendChild(buttonsDiv);
                container.appendChild(playerSection);
            });
        }

        function addScore(playerIndex, points, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate(`addScore-${playerIndex}-${points}`)) return;
            
            // Save to history for undo
            scoreHistory.push({
                playerIndex: playerIndex,
                points: points,
                playerName: players[playerIndex].name
            });
            
            players[playerIndex].score += points;
            updateScoreboard();
            updateUndoButton();

            // Check for winner
            if (players[playerIndex].score >= WINNING_SCORE) {
                setTimeout(() => {
                    showWinner(players[playerIndex]);
                }, 500);
            }
        }

        function undoLastScore(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('undoLastScore')) return;
            
            if (scoreHistory.length === 0) {
                alert('No hay puntos para deshacer');
                return;
            }
            
            const lastAction = scoreHistory.pop();
            players[lastAction.playerIndex].score -= lastAction.points;
            updateScoreboard();
            updateUndoButton();
        }

        function updateUndoButton() {
            const undoBtn = document.getElementById('undoBtn');
            if (undoBtn) {
                if (scoreHistory.length === 0) {
                    undoBtn.disabled = true;
                    undoBtn.style.opacity = '0.5';
                } else {
                    undoBtn.disabled = false;
                    undoBtn.style.opacity = '1';
                }
            }
        }

        function nextRound(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('nextRound')) return;
            // Check if anyone won
            const winner = players.find(p => p.score >= WINNING_SCORE);
            if (winner) {
                showWinner(winner);
                return;
            }

            // Clear score history for new round
            scoreHistory = [];
            
            currentRound++;
            currentReaderIndex = (currentReaderIndex + 1) % players.length;
            
            showTransition();
        }

        function showWinner(winner) {
            document.getElementById('winnerName').textContent = winner.name;
            
            const finalScores = document.getElementById('finalScores');
            finalScores.innerHTML = '';

            const sortedPlayers = [...players].sort((a, b) => b.score - a.score);

            sortedPlayers.forEach((player, index) => {
                const div = document.createElement('div');
                div.className = 'final-score-item';
                const medal = index === 0 ? '' : index === 1 ? '' : index === 2 ? '' : '';
                div.innerHTML = `
                    <span>${medal} ${player.name}</span>
                    <strong>${player.score} puntos</strong>
                `;
                finalScores.appendChild(div);
            });

            showScreen('winnerScreen');
        }

        function resetGame(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            if (preventDuplicate('resetGame')) return;
            players = [];
            currentRound = 1;
            currentReaderIndex = 0;
            usedFlashcards = [];
            
            // Clear player inputs
            const inputs = document.getElementById('playerInputs');
            inputs.innerHTML = `
                <div class="player-input">
                    <input type="text" placeholder="Nombre del Jugador 1" class="player-name-input">
                </div>
                <div class="player-input">
                    <input type="text" placeholder="Nombre del Jugador 2" class="player-name-input">
                </div>
            `;
            
            showScreen('setupScreen');
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // No need for DOMContentLoaded - using inline event handlers for iOS compatibility
    </script>
</body>
</html>
